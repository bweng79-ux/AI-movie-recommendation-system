<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ê¸°ë°˜ ì—°ê´€ ì˜í™” ì‘í’ˆ ì¶”ì²œ ì‹œìŠ¤í…œ</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />
    <style>
        /* [Design System & Variables] - Luxury Dark Theme V2 */
        :root {
            --primary: #FFD700;       /* Gold/Champagne Accent */
            --primary-dark: #ccaa00;
            --secondary: #0a0a0a;     /* Deeper Black Background */
            --surface: #1a1a1a;       /* Card Background */
            --text-main: #fcfcfc;     /* Near-White */
            --text-sub: #a0a0a0;      /* Muted Gray */
            --text-strong: #ffffff;
            --border-color: #383838;  /* Sharper Border */
            --shadow-subtle: 0 5px 20px rgba(0, 0, 0, 0.7);
            --shadow-glow: 0 0 25px rgba(255, 215, 0, 0.4);
            --radius-lg: 10px;
            --font-main: 'Pretendard', sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        
        body {
            font-family: var(--font-main);
            font-weight: 400; 
            background-color: var(--secondary);
            color: var(--text-main);
            line-height: 1.7; 
            background-image: radial-gradient(circle at 10% 20%, rgba(255, 215, 0, 0.05) 0%, transparent 20%),
                              radial-gradient(circle at 90% 80%, rgba(255, 215, 0, 0.07) 0%, transparent 20%);
        }

        /* [Header] */
        header {
            background: var(--secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 70px 20px 40px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }
        
        /* ì œëª© ìœ„ì— ë“¤ì–´ê°€ëŠ” ê³¨ë“œìƒ‰ ë°°ì§€ íƒ€ì´í‹€ */
        .top-badge-title {
            display: inline-block;
            color: var(--primary); 
            font-weight: 600; 
            font-size: 0.9rem;
            letter-spacing: 3px; 
            text-transform: uppercase;
            margin-bottom: 25px; 
            padding: 0 5px;
        }

        /* H1: Pretendard í°íŠ¸ì— ë§ê²Œ êµµê¸° ì¡°ì • */
        h1 {
            font-size: 3.5rem;
            font-weight: 900; 
            letter-spacing: 0.08em; 
            color: var(--text-strong);
            margin-bottom: 5px; 
        }
        
        /* ë¶€ì œ ë‚´ìš© */
        p.subtitle {
            color: var(--text-sub);
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
            font-weight: 400; 
            margin-top: 20px; 
        }

        /* [Main Layout] */
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 50px 20px;
        }

        /* [Input Section] */
        .input-card {
            background: var(--surface);
            padding: 40px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-subtle);
            border: 1px solid var(--border-color);
            margin-bottom: 60px;
        }

        .form-group { margin-bottom: 30px; }
        
        .form-label {
            display: block;
            font-weight: 700; 
            margin-bottom: 10px;
            color: var(--text-main);
            font-size: 1rem;
        }

        input[type="text"] {
            width: 100%;
            padding: 18px 20px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 1.05rem;
            background-color: var(--secondary);
            color: var(--text-main);
            transition: all 0.3s;
            font-family: var(--font-main);
            font-weight: 400; 
        }
        input[type="text"]::placeholder { color: #555; font-weight: 400; }
        input[type="text"]:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.3); 
            background-color: #000;
        }

        .btn-analyze {
            width: 100%;
            padding: 18px;
            background: var(--primary);
            color: var(--secondary); 
            font-size: 1.15rem;
            font-weight: 800;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        .btn-analyze:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: var(--shadow-glow);
        }

        /* [Results Section] */
        .results-header {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        .results-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary);
            letter-spacing: 0.05em;
        }
        .results-meta {
            font-size: 0.9rem;
            color: var(--text-sub);
            font-family: monospace;
            font-weight: 400;
        }

        .movie-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 30px;
        }

        .movie-card {
            background: var(--surface);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-subtle);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        .movie-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.15);
        }
        
        .card-visual { height: 180px; background-color: #333; position: relative; background-image: linear-gradient(to right, #222, #333); }
        .match-overlay {
            position: absolute; top: 15px; right: 15px; background: var(--primary); color: var(--secondary);
            padding: 4px 10px; border-radius: 4px; font-weight: 800; font-size: 0.8rem; z-index: 2;
        }

        .card-body { padding: 25px; }
        
        .movie-title {
            font-size: 1.4rem;
            font-weight: 800; 
            color: var(--text-strong);
            margin-bottom: 10px;
            letter-spacing: 0.02em;
        }
        
        .similarity-brief {
            font-size: 0.95rem;
            color: var(--text-sub);
            margin-bottom: 20px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            font-weight: 400; 
        }

        .sim-bar-container { width: 100%; height: 8px; background: #282828; border-radius: 4px; margin-bottom: 15px; overflow: hidden; }
        .sim-bar-fill { height: 100%; background: var(--primary); box-shadow: 0 0 5px rgba(255, 215, 0, 0.5); width: 0%; transition: width 1s ease-out; }

        .tag-container { display: flex; gap: 8px; flex-wrap: wrap; }
        .tag {
            background: #282828;
            color: var(--primary);
            font-size: 0.75rem;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: 600;
        }

        .btn-load-more {
            background: var(--surface);
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 15px 50px;
            font-size: 1rem;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 50px;
        }
        .btn-load-more:hover {
            background: var(--primary);
            color: var(--secondary);
            transform: scale(1.03);
            box-shadow: var(--shadow-glow);
        }
        .load-more-container { text-align: center; }

        /* [Modal] - ëª¨ë‹¬ì´ í™”ë©´ì„ ì™„ì „íˆ ë®ê³  ë³´ì´ë„ë¡ CSS ìˆ˜ì • */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9); 
            backdrop-filter: blur(15px);
            display: flex; justify-content: center; align-items: center;
            z-index: 1000; 
            opacity: 0; 
            visibility: hidden; /* ì´ˆê¸° ìƒíƒœ: ë³´ì´ì§€ ì•ŠìŒ */
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }

        /* [CRITICAL FIX] .active í´ë˜ìŠ¤ ì ìš© ì‹œ ëª¨ë‹¬ ë³´ì´ê²Œ ì²˜ë¦¬ */
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--surface);
            width: 90%; max-width: 800px;
            border-radius: 15px;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.1);
            border: 1px solid #333;
            max-height: 90vh;
            display: flex; flex-direction: column;
            transform: translateY(20px); transition: transform 0.4s;
        }
        .modal-overlay.active .modal-content { transform: translateY(0); }

        .modal-header {
            background: #000;
            color: var(--primary);
            padding: 25px 30px;
            border-bottom: 1px solid var(--primary);
            display: flex; justify-content: space-between; align-items: center;
        }
        .modal-close {
            background: #282828;
            border: none; color: white; width: 32px; height: 32px; border-radius: 50%;
            cursor: pointer; transition: background 0.2s;
        }
        .modal-close:hover { background: #444; }

        /* Tabs */
        .tabs { display: flex; background: #222; border-bottom: 1px solid #333; }
        .tab-btn {
            padding: 20px 30px; border: none; background: none; font-weight: 600;
            color: #777; cursor: pointer; position: relative; font-size: 1rem;
            transition: color 0.2s;
        }
        .tab-btn.active { color: var(--primary); }
        .tab-btn::after {
            content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 2px;
            background: var(--primary); transform: scaleX(0); transition: transform 0.3s;
        }
        .tab-btn.active::after { transform: scaleX(1); }

        .tab-content { padding: 35px; overflow-y: auto; flex-grow: 1; }
        .tab-pane { display: none; animation: fadeIn 0.4s ease; }
        .tab-pane.active { display: block; }

        /* Detail Boxes */
        .detail-reason {
            background: #222;
            border-left: 4px solid var(--primary);
            padding: 25px;
            border-radius: 6px;
            margin-bottom: 25px;
            color: var(--text-sub);
            font-weight: 400; 
        }
        .detail-reason h4 { color: var(--text-strong); margin-bottom: 10px; font-weight: 700; }
        .detail-reason p { font-weight: 400; line-height: 1.7; }
        .sub-header { color: var(--primary); font-size: 1.3rem; margin-top: 20px; margin-bottom: 10px; font-weight: 600; }

        /* Spoiler */
        .spoiler-container {
            background: #000;
            color: #fff; padding: 30px; border-radius: 10px; text-align: center;
            cursor: pointer; position: relative; border: 1px solid #555;
        }
        .spoiler-container.revealed { background: #111; color: var(--text-main); text-align: left; cursor: default; }
        .spoiler-warning { font-weight: bold; color: var(--primary); display: block; margin-bottom: 10px; }
        .spoiler-text { filter: blur(10px); opacity: 0.8; transition: all 0.5s; line-height: 1.7; font-weight: 400; }
        .spoiler-container.revealed .spoiler-text { filter: blur(0); opacity: 1; }
        .spoiler-hint { color: var(--primary); font-weight: 700; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);}
        .spoiler-container.revealed .spoiler-hint, .spoiler-container.revealed .spoiler-warning { display: none; }

        /* Loading */
        #loading { display: none; text-align: center; padding: 60px 0; }
        .spinner {
            width: 50px; height: 50px; border: 4px solid rgba(255, 215, 0, 0.1);
            border-left-color: var(--primary); border-radius: 50%;
            animation: spin 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            display: inline-block;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        .hidden { display: none; }


    </style>
</head>
<body>

    <header>
        <p class="top-badge-title">HIGH-END DATA MATCHUP | AI MATCHUP ENGINE</p> 
        <h1>AI ê¸°ë°˜ ì—°ê´€ ì˜í™” ì‘í’ˆ ì¶”ì²œ ì‹œìŠ¤í…œ</h1>
        <p class="subtitle">Content Vector & Collaborative Matrixë¥¼ ê¸°ë°˜ìœ¼ë¡œ, ë‹¹ì‹ ì˜ ë‹¤ìŒ ì˜í™”ë¥¼ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤.</p>
    </header>

    <div class="container">
        <section class="input-card">
            <form id="recommendation-form" onsubmit="event.preventDefault(); register();">
                <div class="form-group">
                    <label class="form-label" for="movie-title">ë¶„ì„ ëŒ€ìƒ ì˜í™” (í•„ìˆ˜) - [ì˜í™” ì œëª© ì…ë ¥]</label>
                    <input type="text" id="movie-title" required 
                        placeholder="ì˜í™” ì œëª© ì…ë ¥ - ì‚¬ìš©ìê°€ ê°ëª…ê¹Šê²Œ ë³¸ ì˜í™” ì œëª©, ì—°ê´€ ì‘í’ˆì„ ì¶”ì²œë°›ê³  ì‹¶ì€ ì˜í™” ì œëª©">
                </div>
                <div class="form-group">
                    <label class="form-label" for="user-request">ìƒì„¸ ìš”ì²­ ì‚¬í•­ (ì„ íƒ) - [ì¶”ì²œ ì„¸ë¶€ ì¡°ê±´ ì…ë ¥]</label>
                    <input type="text" id="user-request" 
                        placeholder="ì˜ˆ: ì´ ì˜í™”ì™€ ë¹„ìŠ·í•œ 'ì¥ë¥´'ë¥¼ ì¶”ì²œí•´ì¤˜, ì´ ì˜í™”ì˜ 'ë°°ìš°ê°€ ë¹„ìŠ·í•œ ì—­í• 'ë¡œ ë‚˜ì˜¤ëŠ” ì‘í’ˆì„ ì¶”ì²œí•´ì¤˜, 'ë¹„ìŠ·í•œ ë¶„ìœ„ê¸°'ì˜ ì‘í’ˆì„ ì¶”ì²œí•´ì¤˜">
                </div>
                <button type="submit" class="btn-analyze">ë¶„ì„ ë° ì¶”ì²œ ìš”ì²­ (ACCESS THE MATRIX)</button>
            </form>
        </section>

        <div id="loading">
            <div class="spinner"></div>
            <p style="margin-top: 10px; font-weight: 600; color: #a0a0a0;">AI ë²¡í„° ë¶„ì„ ë° ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê³„ì‚° ì¤‘...</p>
        </div>

        <section id="results-area" class="hidden">
            <div class="results-header">
                <span class="results-title">ANALYSIS REPORT</span>
                <span class="results-meta">Engine: Hybrid V2.1 | Status: ONLINE</span>
            </div>
            
            <div class="movie-grid" id="movie-grid">
                </div>

            <div class="load-more-container">
                <button id="btn-load-more" class="btn-load-more" onclick="loadMore()">ë” ë§ì€ ì‘í’ˆ ì¶”ì²œ (+3)</button>
            </div>
        </section>
    </div>

    <div class="modal-overlay" id="detail-modal" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2 id="modal-title" style="margin:0; font-size: 1.5rem; letter-spacing: 0.05em; font-weight: 600;"></h2>
                <button class="modal-close" onclick="closeModalDirect()">Ã—</button>
            </div>
            
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('tab-analysis')">ìƒì„¸ AI ë¶„ì„</button>
                <button class="tab-btn" onclick="switchTab('tab-plot')">í•µì‹¬ ì¤„ê±°ë¦¬</button>
                <button class="tab-btn" onclick="switchTab('tab-reviews')">í‰ë¡  ë° í‰ê°€</button>
            </div>

            <div class="tab-content">
                <div id="tab-analysis" class="tab-pane active">
                    <h3 class="sub-header">AI ë§¤ì¹­ ìƒì„¸ ë¦¬í¬íŠ¸: ìœ ì‚¬ì„± ë”¥-ë‹¤ì´ë¸Œ</h3>
                    <div class="detail-reason" id="modal-analysis-text">
                        </div>
                    <p style="color:#777; font-size:0.9rem; font-weight: 400;">
                        * ë¶„ì„ ê·¼ê±°: NLP í…ìŠ¤íŠ¸ ì„ë² ë”© (BERT) ë° ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ì¸¡ì •.
                    </p>
                </div>

                <div id="tab-plot" class="tab-pane">
                    <h3 class="sub-header">ì‹œë†‰ì‹œìŠ¤ & ì£¼ìš” í”Œë¡¯ ë¶„ì„</h3>
                    <div class="spoiler-container" onclick="this.classList.add('revealed')">
                        <span class="spoiler-warning">âš ï¸ ì´ ë¶€ë¶„ì€ í•µì‹¬ ì¤„ê±°ë¦¬ì™€ ìŠ¤í¬ì¼ëŸ¬ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. í´ë¦­ ì‹œ ë¸”ë¼ì¸ë“œê°€ í•´ì œë©ë‹ˆë‹¤.</span>
                        <div class="spoiler-hint">CLICK TO VIEW PLOT</div>
                        <p class="spoiler-text" id="modal-plot-text">
                            </p>
                    </div>
                </div>

                <div id="tab-reviews" class="tab-pane">
                    <h3 class="sub-header">ì‹œì²­ì/í‰ë¡ ê°€ ì¸ë±ìŠ¤ (ê°€ìƒ ë°ì´í„°)</h3>
                    <div id="modal-reviews-list">
                        </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // [í•µì‹¬ ìš”êµ¬ ì‚¬í•­]
        const SERVER_URL = "https://ai-movie--bween78.replit.app"; 

        // Global State
        let currentRecommendations = [];
        let displayedCount = 0;
        let loadMoreCount = 0;
        const INITIAL_COUNT = 5;
        const ADDITIONAL_COUNT = 3;
        const MAX_LOAD_CLICKS = 2;

        async function register() {
            const titleInput = document.getElementById('movie-title').value;
            const requestInput = document.getElementById('user-request').value;

            if (!titleInput) {
                alert("ë¶„ì„ ëŒ€ìƒ ì˜í™” ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            // UI ìƒíƒœ ë³€ê²½: ë¡œë”© ì‹œì‘
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results-area').classList.add('hidden');
            document.getElementById('movie-grid').innerHTML = '';
            document.getElementById('btn-load-more').style.display = 'inline-block';
            displayedCount = 0;
            loadMoreCount = 0;

            const requestData = {
                title: titleInput,
                details: requestInput
            };

            try {
                // ì‹¤ì œ ë°±ì—”ë“œ /register ì—”ë“œí¬ì¸íŠ¸ë¡œ POST ìš”ì²­ ì „ì†¡ (AI í˜¸ì¶œ)
                const response = await fetch(`${SERVER_URL}/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                
                // ğŸŒŸ [í•µì‹¬] AIê°€ ë³´ë‚¸ ì‹¤ì œ ì¶”ì²œ ë°ì´í„° (result.recommendations)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
                allRecommendations = result.recommendations;
                renderCards();
                
                console.log("AI ì¶”ì²œ ë°ì´í„° ìˆ˜ì‹  ì™„ë£Œ");
                
            } catch (error) {
                // í†µì‹  ì‹¤íŒ¨ ë˜ëŠ” ì„œë²„ ì˜¤ë¥˜ ì²˜ë¦¬ (ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ, í‚¤ ì˜¤ë¥˜ ë“±)
                console.error("ë°±ì—”ë“œ ì„œë²„ í†µì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ. Mock ë°ì´í„°ë¥¼ ëŒ€ì²´ ì‚¬ìš©í•©ë‹ˆë‹¤:", error);
                
                // ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì„ ë•Œë§Œ Mock ë°ì´í„°ë¥¼ fallbackìœ¼ë¡œ ì‚¬ìš©
                generateMockData(titleInput, requestInput);
                renderCards();

            } finally {
                // UI ìƒíƒœ ë³€ê²½: ë¡œë”© ì¢…ë£Œ ë° ê²°ê³¼ ì˜ì—­ í‘œì‹œ
                document.getElementById('loading').style.display = 'none';
                document.getElementById('results-area').classList.remove('hidden');
            }
        }
        /**
         * Mock Data Generator - Includes highly detailed analysis text
         */
        function generateMockData(sourceTitle, details) {
            currentRecommendations = [];
            const commonGenres = ["SF ìŠ¤ë¦´ëŸ¬", "ëŠì™€ë¥´", "ì‹¬ë¦¬ ë“œë¼ë§ˆ", "ì•¡ì…˜ ì–´ë“œë²¤ì²˜", "ë¯¸ìŠ¤í„°ë¦¬"];
            
            for (let i = 1; i <= 11; i++) {
                const matchRate = 98 - i * 2;
                const matchScore = `${matchRate}%`;
                const similarityAlgorithm = (i % 3 === 1) ? "ì½˜í…ì¸  ê¸°ë°˜ í•„í„°ë§ (ê°ë… ê°€ì¤‘ì¹˜)" : 
                                            (i % 3 === 2) ? "í˜‘ì—… í•„í„°ë§ (ì‚¬ìš©ì ì·¨í–¥ ë§¤ì¹­)" : 
                                                            "í•˜ì´ë¸Œë¦¬ë“œ ì—”ì§„ (í”Œë¡¯ ë²¡í„° ì¤‘ì‹¬)";

                const reasonType = (details && details.includes("ë°°ìš°")) ? "ì£¼ì—° ë°°ìš°ì˜ í˜ë¥´ì†Œë‚˜ ìœ ì‚¬ì„±" : 
                                   (details && details.includes("ê°ë…")) ? "ì—°ì¶œ ë¯¸ì¥ì„¼ ë° ìŠ¤íƒ€ì¼ì˜ ì¼ì¹˜" : 
                                   "í•µì‹¬ í”Œë¡¯ êµ¬ì¡° ë° ì£¼ì œ ì˜ì‹ì˜ ìœ ì‚¬ì„±";
                
                const briefReason = `[${reasonType}] ê¸°ë°˜ ì¶”ì²œ - ë§¤ì¹­ë¥  ${matchScore}`;

                // --- ìƒì„¸ ë¶„ì„ í…ìŠ¤íŠ¸ ìƒì„± (ê¸¸ê³  êµ¬ì¡°í™”ëœ í˜•íƒœ) ---
                let detailedAnalysis = `
                    <h4>ğŸ” ìš”ì²­í•˜ì‹  ì‘í’ˆ '${sourceTitle}'ê³¼ì˜ ë§¤ì¹­ ì‹¬ì¸µ ë¶„ì„</h4>
                    <p>ë³¸ ì‘í’ˆì€ '${sourceTitle}'ì˜ **í•µì‹¬ ì„œì‚¬ ë²¡í„°**ë¥¼ ë¶„ì„í•œ ê²°ê³¼, ${matchScore}ì˜ ë†’ì€ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ì ìˆ˜ë¥¼ íšë“í–ˆìŠµë‹ˆë‹¤. ì´ëŠ” ë‹¨ìˆœí•œ ì¥ë¥´ ë§¤ì¹­ì„ ë„˜ì–´ì„  **ì£¼ì¸ê³µì˜ ì‹¬ë¦¬ì  ê¶¤ì ê³¼ ì£¼ì œ ì˜ì‹**ì˜ ìœ ì‚¬ì„±ì— ê¸°ë°˜í•©ë‹ˆë‹¤.</p>
                    
                    <h3 class="sub-header">1. í”Œë¡¯ ë° ì„œì‚¬ êµ¬ì¡°ì˜ ìœ ì‚¬ì„± (${i % 3 === 0 ? 'í•˜ì´ë¸Œë¦¬ë“œ ì—”ì§„' : 'ì½˜í…ì¸  ê¸°ë°˜ ë¶„ì„'})</h3>
                    <p><strong>A. ì‹œì‘ì ì˜ ë”œë ˆë§ˆ:</strong> ë‘ ì˜í™” ëª¨ë‘ ì£¼ì¸ê³µì´ 'ì™¸ë¶€ì˜ ê±°ëŒ€í•œ ì‹œìŠ¤í…œ' ë˜ëŠ” 'ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ìš´ëª…ì  ìƒí™©'ì— ë§ì„œì•¼ í•˜ëŠ” **ê·¹í•œì˜ ë”œë ˆë§ˆ**ì—ì„œ ì‹œì‘í•©ë‹ˆë‹¤. ${sourceTitle}ì—ì„œ... [ë¶„ì„ ë‚´ìš©]. ë³¸ ì¶”ì²œì‘ì—ì„œëŠ” ì´ ë”œë ˆë§ˆê°€ [ìœ ì‚¬í•œ ìƒí™©]ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ë©° ê´€ê°ì˜ ëª°ì…ë„ë¥¼ ë†’ì…ë‹ˆë‹¤.</p>
                    <p><strong>B. ë¹„ì„ í˜•ì  ì‹œê°„/ê³µê°„ êµ¬ì¡°:</strong> ë‘ ì‘í’ˆ ëª¨ë‘ ì‹œê°„, ê³µê°„, í˜¹ì€ í˜„ì‹¤ì˜ ë²•ì¹™ì´ ì™œê³¡ë˜ê±°ë‚˜ ë³µì¡í•˜ê²Œ ì¸µìœ„ë¥¼ ì´ë£¨ëŠ” ë¹„ì„ í˜•ì  êµ¬ì¡°ë¥¼ ê³µìœ í•©ë‹ˆë‹¤. NLP í…ìŠ¤íŠ¸ ì„ë² ë”© ë¶„ì„ ê²°ê³¼, 'í˜¼ë€', 'ê²½ê³„', 'ì§„ì‹¤', 'íƒìƒ‰' ë“±ì˜ í‚¤ì›Œë“œì—ì„œ 90% ì´ìƒì˜ ìœ ì‚¬ íŒ¨í„´ì´ ì¶”ì¶œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                    
                    <h3 class="sub-header">2. í†¤ & ë¬´ë“œ (Tone & Mood) ë§¤ì¹­ (í˜‘ì—… í•„í„°ë§ ê¸°ë°˜)</h3>
                    <p>ì´ ì‘í’ˆì€ '${sourceTitle}'ì— 'ê°•ë ¬í•œ ëª°ì…ê°'ê³¼ 'ì‹¬ê°í•œ ê¸´ì¥ê°'ì„ ë¶€ì—¬í–ˆë˜ **íŠ¹ìœ ì˜ í†¤ ì•¤ ë¬´ë“œ**ë¥¼ ì™„ë²½í•˜ê²Œ ì¬í˜„í•©ë‹ˆë‹¤. ${sourceTitle}ë¥¼ ì‹œì²­í•œ í›„ [ëª°ì…ë„/ê¸´ì¥ê°] í‰ì ì„ ë†’ê²Œ ì¤€ ì‚¬ìš©ì ê·¸ë£¹(${i * 1000}ëª…)ì˜ 70% ì´ìƒì´ ë³¸ ì¶”ì²œì‘ ì—­ì‹œ ë†’ê²Œ í‰ê°€í–ˆìŠµë‹ˆë‹¤. íŠ¹íˆ ì¹´ë©”ë¼ì˜ ì›€ì§ì„ê³¼ ì‚¬ìš´ë“œ ë””ìì¸ì—ì„œ ì˜¤ëŠ” **íì‡„ì ì´ê³  ì••ë°•ê° ìˆëŠ” ë¶„ìœ„ê¸°**ê°€ ì‚¬ìš©ì ì·¨í–¥ ë§¤ì¹­ì— ê²°ì •ì ì¸ ì—­í• ì„ í–ˆìŠµë‹ˆë‹¤.</p>
                    
                    <h3 class="sub-header">3. ì•Œê³ ë¦¬ì¦˜ ìµœì¢… ë³´ê³ ì„œ</h3>
                    <p>ìµœì¢…ì ìœ¼ë¡œ ë³¸ ì¶”ì²œì€ ${matchScore}ì˜ ìœ ì‚¬ë„ë¥¼ ê¸°ë¡í–ˆìœ¼ë©°, ì´ ì¤‘ ${i % 3 === 1 ? 'ê°ë…ì˜ ë¯¸í•™ì  íŠ¹ì„±(ê°€ì¤‘ì¹˜ +20%)' : 'ì¤„ê±°ë¦¬ í‚¤ì›Œë“œ ë²¡í„° ì¼ì¹˜ë„(ê°€ì¤‘ì¹˜ +35%)'}ê°€ ê°€ì¥ í° ì˜í–¥ì„ ë¯¸ì³¤ìŠµë‹ˆë‹¤. ì¦‰, ìš”ì²­í•˜ì‹  ëŒ€ë¡œ **${reasonType}**ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ë¶„ì„ëœ ìµœì ì˜ ì‘í’ˆì…ë‹ˆë‹¤.</p>
                `;
                
                // --- ìƒì„¸ ì¤„ê±°ë¦¬ (Plot) ---
                const detailedPlot = `
                    (ìŠ¤í¬ì¼ëŸ¬ í¬í•¨) ì´ ì˜í™”ì˜ ì£¼ì¸ê³µì€ ${sourceTitle}ì˜ ì£¼ì¸ê³µê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ê°œì¸ì ì¸ íŠ¸ë¼ìš°ë§ˆ ë˜ëŠ” ê±°ëŒ€í•œ ì‹œìŠ¤í…œì˜ í¬ìƒì–‘ìœ¼ë¡œ ë“±ì¥í•©ë‹ˆë‹¤. ì´ˆë°˜ë¶€, ê·¸ëŠ” [ì¶©ê²©ì ì¸ ì‚¬ê±´]ì„ ê²ªê²Œ ë˜ëŠ”ë°, ì´ ì‚¬ê±´ì´ ê·¸ê°€ ì´í›„ì˜ ëª¨ë“  ì„ë¬´ë¥¼ ìˆ˜í–‰í•˜ê²Œ ë˜ëŠ” ë™ê¸°(Motivation)ê°€ ë©ë‹ˆë‹¤. ì¤‘ë°˜ë¶€ì—ì„œëŠ” [ì¡°ë ¥ìì˜ ë“±ì¥]ê³¼ í•¨ê»˜ ê·¸ë“¤ì´ ì«“ëŠ” [ë¯¸ìŠ¤í„°ë¦¬í•œ ì˜¤ë¸Œì íŠ¸ ë˜ëŠ” ì¸ë¬¼]ì˜ ì •ì²´ê°€ ì„œì„œíˆ ë“œëŸ¬ë‚˜ë©°, ì´ë•Œë¶€í„° í”Œë¡¯ì˜ ì†ë„ê°€ ê¸‰ê²©íˆ ë¹¨ë¼ì§‘ë‹ˆë‹¤. í´ë¼ì´ë§¥ìŠ¤ëŠ” ë‹¨ìˆœí•œ ì•¡ì…˜ ëŒ€ê²°ì„ ë„˜ì–´ì„  **[ì£¼ì¸ê³µì˜ ë‚´ì  ê°ˆë“±ê³¼ ì™¸ë¶€ í˜„ì‹¤ì˜ ì¶©ëŒ]**ì„ í†µí•´ ì˜ˆìƒì¹˜ ëª»í•œ ë°˜ì „ìœ¼ë¡œ ë§ˆë¬´ë¦¬ë˜ë©°, ê·¸ ê²°ë§ì€ ì—¬ì „íˆ ë§ì€ í•´ì„ì˜ ì—¬ì§€ë¥¼ ë‚¨ê¹ë‹ˆë‹¤.
                `;

                currentRecommendations.push({
                    id: i,
                    title: `ì¶”ì²œì‘ ${i} : ${sourceTitle}ì˜ ì‹œë„¤ë§ˆí‹± í›„ê³„ì`,
                    matchScore: matchScore,
                    posterColor: `hsl(${30 + i * 20}, 40%, 40%)`,
                    briefReason: briefReason,
                    fullReason: detailedAnalysis,
                    tags: ["AI-BEST", similarityAlgorithm.split(' ')[0], commonGenres[i % 5]],
                    plot: detailedPlot,
                    reviews: [
                        { source: "í‰ë¡ ê°€ ì¸ë±ìŠ¤ (êµ¬ê¸€ ê¸°ë°˜)", score: "93%", text: "ê¸°ìˆ ì  ì™„ì„±ë„ì™€ ì£¼ì œì˜ì‹ ëª¨ë‘ ì „ì‘ì„ ë›°ì–´ë„˜ëŠ” ê±¸ì‘ì´ë‹¤. (by R.T. Analyst)" },
                        { source: "ì‹œì²­ì ë°˜ì‘ (ë„¤ì´ë²„ ê¸°ë°˜)", score: "9.2", text: "ë‘ ë²ˆ, ì„¸ ë²ˆ ë´ì•¼ ë¹„ë¡œì†Œ ë³´ì´ëŠ” ë†€ë¼ìš´ ë””í…Œì¼ë“¤. ì—¬ìš´ì´ ì˜¤ë˜ê°€ëŠ” ì˜í™”." },
                    ]
                });
            }
        }
        
        // --- UI Rendering and Interaction Logic ---

        function renderCards() {
            const grid = document.getElementById('movie-grid');
            
            let targetCount = INITIAL_COUNT + (loadMoreCount * ADDITIONAL_COUNT);
            if (targetCount > currentRecommendations.length) targetCount = currentRecommendations.length;

            grid.innerHTML = '';

            for (let i = 0; i < targetCount; i++) {
                const movie = currentRecommendations[i];
                const card = document.createElement('div');
                card.className = 'movie-card';
                card.onclick = () => openModal(i);
                
                card.innerHTML = `
                    <div class="card-visual" style="background-color: ${movie.posterColor};">
                        <span class="match-overlay">MATCH ${movie.matchScore}</span>
                    </div>
                    <div class="card-body">
                        <h3 class="movie-title">${movie.title}</h3>
                        <p class="similarity-brief">${movie.briefReason}</p>
                        <div class="sim-bar-container">
                            <div class="sim-bar-fill" style="width: ${movie.matchScore};"></div>
                        </div>
                        <div class="tag-container">
                            ${movie.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            }
            displayedCount = targetCount;

            const btn = document.getElementById('btn-load-more');
            if (loadMoreCount >= MAX_LOAD_CLICKS || displayedCount >= currentRecommendations.length) {
                btn.style.display = 'none';
            }
        }

        function loadMore() {
            if (loadMoreCount < MAX_LOAD_CLICKS) {
                loadMoreCount++;
                renderCards();
            }
        }

        function openModal(index) {
            const movie = currentRecommendations[index];
            const modal = document.getElementById('detail-modal');
            
            document.getElementById('modal-title').innerText = movie.title;
            document.getElementById('modal-analysis-text').innerHTML = movie.fullReason;
            document.getElementById('modal-plot-text').innerText = movie.plot;
            
            const reviewContainer = document.getElementById('modal-reviews-list');
            reviewContainer.innerHTML = movie.reviews.map(r => `
                <div class="review-item" style="border-bottom: 1px solid #333; padding: 15px 0;">
                    <div style="margin-bottom: 5px;">
                        <span style="color: var(--primary); font-weight: 700;">${r.source}</span>
                        <span style="color: #ccc; margin-left: 10px; font-weight: 400;">â˜… ${r.score}</span>
                    </div>
                    <p style="color: var(--text-sub); font-weight: 400;">"${r.text}"</p>
                </div>
            `).join('');

            switchTab('tab-analysis');
            document.querySelector('.spoiler-container').classList.remove('revealed');

            // [CRITICAL FIX] ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ì— active í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ì—¬ ë³´ì´ê²Œ í•¨
            modal.classList.add('active'); 
        }

        function closeModal(event) {
            if (event.target.id === 'detail-modal') {
                closeModalDirect();
            }
        }
        
        function closeModalDirect() {
            // ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ì—ì„œ active í´ë˜ìŠ¤ë¥¼ ì œê±°í•˜ì—¬ ìˆ¨ê¹€
            document.getElementById('detail-modal').classList.remove('active'); 
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));

            const buttons = document.querySelectorAll('.tabs .tab-btn');
            if(tabId === 'tab-analysis') buttons[0].classList.add('active');
            if(tabId === 'tab-plot') buttons[1].classList.add('active');
            if(tabId === 'tab-reviews') buttons[2].classList.add('active');

            document.getElementById(tabId).classList.add('active');
        }

        // ì´ˆê¸° ë¡œë“œ ì‹œ ë¡œë”© ë° ê²°ê³¼ ì˜ì—­ ìˆ¨ê¹€
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('results-area').classList.add('hidden');
        });
    </script>
</body>
</html>





